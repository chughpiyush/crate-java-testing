description = 'Crate Testing'

apply plugin: 'idea'
apply plugin: 'java'

group = "io.crate"

repositories {
    mavenCentral()
    jcenter()
}

dependencies {
    compile "junit:junit:$junitVersion"
    compile "io.crate:crate-client:$crateClientVersion"
    compile "org.apache.commons:commons-compress:1.2"
    testCompile ("com.carrotsearch.randomizedtesting:randomizedtesting-runner:$randomizedTestingVersion") {
        exclude group: 'junit', module: 'junit'
    }
}

idea {
    project {
        languageLevel = 'JDK_1_7'

        ipr {
            withXml { provider ->
                def node = provider.asNode()
                def copyrightManager = node.component.find { it.'@name' == 'CopyrightManager' }
                copyrightManager.@default = "CrateASL2"
                def aslCopyright = copyrightManager.copyright.find { it.option.find { it.@name == "myName" }?.@value == "CrateASL2" }
                if (aslCopyright == null) {
                    copyrightManager.append(new XmlParser().parse(file("copyright.xml")))
                }
            }
        }
    }
}

task wrapper(type: Wrapper) {
    gradleVersion = '2.8'
}
